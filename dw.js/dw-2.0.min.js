/*! datawrapper - v1.8.2 - 2015-01-14 */
(function(){function t(t,e){return new RegExp("(\\"+t+"|\\r?\\n|\\r|^)(?:"+e+"([^"+e+"]*(?:"+e+'"[^'+e+"]*)*)"+e+"|([^"+e+"\\"+t+"\\r\\n]*))","gi")}var e={};
// if (typeof 'define' !== 'undefined' && define.amd) {
"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.dw=e):window.dw=e,e.dataset=function(t,e){function n(t){for(var e=t.name(),n=e,a=1;r.hasOwnProperty(n);)n=e+"."+a++;n!=e&&t.name(n)}var r={},a=t.slice(0);_.each(t,function(t){n(t),r[t.name()]=t}),e=_.extend(e,{});var i={columns:function(){return t},column:function(e){if(_.isString(e)){if(void 0!==r[e])return r[e];throw'No column found with that name: "'+e+'"'}if(!(0>e)){if(void 0!==t[e])return t[e];throw"No column found with that index: "+e}},numColumns:function(){return t.length},numRows:function(){return t[0].length},eachColumn:function(e){_.each(t,e)},hasColumn:function(e){return void 0!==(_.isString(e)?r[e]:t[e])},indexOf:function(e){return i.hasColumn(e)?_.indexOf(t,r[e]):-1},list:function(){return _.range(t[0].length).map(function(e){var n={};return _.each(t,function(t){n[t.name()]=t.val(e)}),n})},toCSV:function(){var e="",n=",",r='"';return _.each(t,function(t,a){var i=t.title();i.indexOf(r)>-1&&i.replace(r,"\\"+r),i.indexOf(n)>-1&&(i=r+i+r),e+=(a>0?n:"")+i}),_.each(_.range(i.numRows()),function(a){e+="\n",_.each(t,function(t,i){var u=""+("date"==t.type()?t.raw(a):t.val(a));u.indexOf(r)>-1&&u.replace(r,"\\"+r),u.indexOf(n)>-1&&(u=r+u+r),e+=(i>0?n:"")+u})}),e},filterColumns:function(e){return t=_.filter(t,function(t){return!e[t.name()]}),_.each(e,function(t,e){t&&r[e]&&delete r[e]}),i},eachRow:function(t){var e;for(e=0;e<i.numRows();e++)t(e);return i},add:function(e){return n(e),t.push(e),r[e.name()]=e,i},reset:function(){return t=a.slice(0),r={},_.each(t,function(t){r[t.name()]=t}),i}};return i},e.column=function(t,n,r){function a(t){if(_.every(n,_.isNumber))return e.column.types.number();if(_.every(n,_.isDate))return e.column.types.date();var r,a=[e.column.types.date(t),e.column.types.number(t),e.column.types.text()],i=n.length,u=.1;return _.each(n,function(t){_.each(a,function(e){e.parse(t)})}),_.every(a,function(t){return t.errors()/i<u&&(r=t),!r}),r}var i=_.map(_.shuffle(_.range(n.length)).slice(0,200),function(t){return n[t]});r=r?e.column.types[r](i):a(i);var u,o,s,c=n.slice(0),f={name:function(){return arguments.length?(t=arguments[0],f):e.utils.purifyHtml(t)},title:function(){return arguments.length?(s=arguments[0],f):e.utils.purifyHtml(s||t)},length:n.length,val:function(t,a){if(!arguments.length)return void 0;var i=a?c:n;return 0>t&&(t+=i.length),r.parse(e.utils.purifyHtml(i[t]))},values:function(t){var a=t?c:n;return a=_.map(a,e.utils.purifyHtml),_.map(a,r.parse)},each:function(t){for(var e=0;e<n.length;e++)t(f.val(e),e)},raw:function(t,r){return arguments.length?2==arguments.length?(n[t]=r,f):e.utils.purifyHtml(n[t]):n},type:function(t){if(t===!0)return r;if(_.isString(t)){if(e.column.types[t])return r=e.column.types[t](i),f;throw"unknown column type: "+t}return r.name()},range:function(){return r.toNum?(u||(u=[Number.MAX_VALUE,-Number.MAX_VALUE],f.each(function(t){t=r.toNum(t),_.isNumber(t)&&!_.isNaN(t)&&(t<u[0]&&(u[0]=t),t>u[1]&&(u[1]=t))}),u[0]=r.fromNum(u[0]),u[1]=r.fromNum(u[1])),u):!1},total:function(){return r.toNum?(o||(o=0,f.each(function(t){o+=r.toNum(t)}),o=r.fromNum(o)),o):!1},filterRows:function(t){return n=[],arguments.length?_.each(t,function(t){n.push(c[t])}):n=c.slice(0),f.length=n.length,u=o=!1,f},toString:function(){return t+" ("+r.name()+")"},indexOf:function(t){return _.find(_.range(n.length),function(e){return f.val(e)==t})}};return f},e.column.types={},e.column.types.text=function(){return{parse:_.identity,errors:function(){return 0},name:function(){return"text"},formatter:function(){return _.identity},isValid:function(){return!0},format:function(){}}},e.column.types.number=function(t){function e(t,e){return 0===t?0:Math.round(e-Math.ceil(Math.log(Math.abs(t))/Math.LN10))}var n,r=0,a={"-.":/^ *[-–—]?[0-9]*(\.[0-9]+)?(e[\+\-][0-9]+)?%? *$/,"-,":/^ *[-–—]?[0-9]*(,[0-9]+)?%? *$/,",.":/^ *[-–—]?[0-9]{1,3}(,[0-9]{3})*(\.[0-9]+)?%? *$/,".,":/^ *[-–—]?[0-9]{1,3}(\.[0-9]{3})*(,[0-9]+)?%? *$/," .":/^ *[-–—]?[0-9]{1,3}( [0-9]{3})*(\.[0-9]+)?%? *$/," ,":/^ *[-–—]?[0-9]{1,3}( [0-9]{3})*(,[0-9]+)?%? *$/," .":/^ *[-–—]?[0-9]{1,3}( [0-9]{3})*(\.[0-9]+)?%? *$/," ,":/^ *[-–—]?[0-9]{1,3}( [0-9]{3})*(,[0-9]+)?%? *$/},i={"-.":"1234.56","-,":"1234,56",",.":"1,234.56",".,":"1.234,56"," .":"1 234.56"," ,":"1 234,56"," .":"1 234.56"," ,":"1 234,56"},u={na:1,"n/a":1,"-":1,":":1},o={},s=["-.",0];t=t||[],_.each(t,function(t){_.each(a,function(e,n){void 0===o[n]&&(o[n]=0),e.test(t)&&(o[n]+=1,o[n]>s[1]&&(s[0]=n,s[1]=o[n]))})}),n=s[0];var c={parse:function(t){if(_.isNumber(t)||_.isUndefined(t)||_.isNull(t))return t;var e=t.replace("%","").replace("–","-").replace("—","-");return"-"!=n[0]&&(e=e.replace(n[0],"")),"."!=n[1]&&(e=e.replace(n[1],".")),isNaN(e)||""===e?(u[e.toLowerCase()]||""===e||r++,t):Number(e)},toNum:function(t){return t},fromNum:function(t){return t},errors:function(){return r},name:function(){return"number"},formatter:function(t){var n=t["number-format"]||"-",r=Number(t["number-divisor"]||0),a=(t["number-append"]||"").replace(/ /g," "),i=(t["number-prepend"]||"").replace(/ /g," ");return function(t,u,o){if(isNaN(t))return t;var s=n;if(0!==r&&"-"==s&&(s="n1"),0!==r&&(t=Number(t)/Math.pow(10,r)),"s"==s.substr(0,1)){var c=+s.substr(1);s="n"+Math.max(0,e(t,c))}return o&&(s="n0"),"-"==s&&(s=t==Math.round(t)?"n0":t==.1*Math.round(10*t)?"n1":"n2"),t=Globalize.format(t,"-"!=s?s:null),u?i+t+a:t}},isValid:function(t){return""===t||u[String(t).toLowerCase()]||_.isNumber(c.parse(t))},ambiguousFormats:function(){var t=[];return _.each(o,function(e,n){e==s[1]&&t.push([n,i[n]])}),t},format:function(t){return arguments.length?(n=t,c):n}};return c},e.column.types.date=function(t){function e(t,e){var n=c[e];return _.isRegExp(n.test)?n.test.test(t):n.test(t,e)}function n(t,e){var n=c[e];return _.isRegExp(n.parse)?t.match(n.parse):n.parse(t,e)}function r(t,e,n){var r=new Date(Date.UTC(t,0,3));return r.setUTCDate(3-r.getUTCDay()+7*(e-1)+parseInt(n,10)),r}function a(t){var e=t.getUTCDay(),n=new Date(t.valueOf());n.setDate(n.getDate()-(e+6)%7+3);var r=n.getUTCFullYear(),a=Math.floor((n.getTime()-new Date(r,0,1,-6))/864e5);return[r,1+Math.floor(a/7),e>0?e:7]}var i,u=0,o={},s=["",0],c={YYYY:{test:/^ *(?:1[7-9]|20)\d{2} *$/,parse:/^ *(\d{4}) *$/,precision:"year"},"YYYY-H":{test:/^ *[12]\d{3}[ \-\/]?[hH][12] *$/,parse:/^ *(\d{4})[ \-\/]?[hH]([12]) *$/,precision:"half"},"H-YYYY":{test:/^ *[hH][12][ \-\/][12]\d{3} *$/,parse:/^ *[hH]([12])[ \-\/](\d{4}) *$/,precision:"half"},"YYYY-Q":{test:/^ *[12]\d{3}[ \-\/]?[qQ][1234] *$/,parse:/^ *(\d{4})[ \-\/]?[qQ]([1234]) *$/,precision:"quarter"},"Q-YYYY":{test:/^ *[qQ]([1234])[ \-\/][12]\d{3} *$/,parse:/^ *[qQ]([1234])[ \-\/](\d{4}) *$/,precision:"quarter"},"YYYY-M":{test:/^ *([12]\d{3}) ?[ \-\/\.mM](0?[1-9]|1[0-2]) *$/,parse:/^ *(\d{4}) ?[ \-\/\.mM](0?[1-9]|1[0-2]) *$/,precision:"month"},"M-YYYY":{test:/^ *(0?[1-9]|1[0-2]) ?[ \-\/\.][12]\d{3} *$/,parse:/^ *(0?[1-9]|1[0-2]) ?[ \-\/\.](\d{4}) *$/,precision:"month"},"YYYY-WW":{test:/^ *[12]\d{3}[ -]?[wW](0?[1-9]|[1-4]\d|5[0-3]) *$/,parse:/^ *(\d{4})[ -]?[wW](0?[1-9]|[1-4]\d|5[0-3]) *$/,precision:"week"},"MM/DD/YYYY":{test:/^ *(0?[1-9]|1[0-2])([\-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2([12]\d{3})$/,parse:/^ *(0?[1-9]|1[0-2])([\-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2(\d{4})$/,precision:"day"},"DD/MM/YYYY":{test:/^ *(0?[1-9]|[1-2]\d|3[01])([\-\.\/ ?])(0?[1-9]|1[0-2])\2([12]\d{3})$/,parse:/^ *(0?[1-9]|[1-2]\d|3[01])([\-\.\/ ?])(0?[1-9]|1[0-2])\2(\d{4})$/,precision:"day"},"YYYY-MM-DD":{test:/^ *([12]\d{3})([\-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01])$/,parse:/^ *(\d{4})([\-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01])$/,precision:"day"},"YYYY-WW-d":{test:/^ *[12]\d{3}[ \-]?[wW](0?[1-9]|[1-4]\d|5[0-3])(?:[ \-]?[1-7]) *$/,parse:/^ *(\d{4})[ \-]?[wW](0?[1-9]|[1-4]\d|5[0-3])(?:[ \-]?([1-7])) *$/,precision:"day"},"MM/DD/YYYY HH:MM":{test:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,parse:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,precision:"day-minutes"},"DD.MM.YYYY HH:MM":{test:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,parse:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,precision:"day-minutes"},"YYYY-MM-DD HH:MM":{test:/^ *([12]\d{3})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,parse:/^ *(\d{4})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,precision:"day-minutes"},"MM/DD/YYYY HH:MM:SS":{test:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,parse:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,precision:"day-seconds"},"DD.MM.YYYY HH:MM:SS":{test:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,parse:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,precision:"day-seconds"},"YYYY-MM-DD HH:MM:SS":{test:/^ *([12]\d{3})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,parse:/^ *(\d{4})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,precision:"day-seconds"}};t=t||[],_.each(c,function(n,r){_.each(t,function(t){void 0===o[r]&&(o[r]=0),e(t,r)&&(o[r]+=1,o[r]>s[1]&&(s[0]=r,s[1]=o[r]))})}),i=s[0];var f={parse:function(t){if(_.isDate(t)||_.isUndefined(t))return t;if(!i||!_.isString(t))return u++,t;var a=n(t,i);if(!a)return u++,t;switch(e(t,i)||u++,i){case"YYYY":return new Date(a[1],0,1);case"YYYY-H":return new Date(a[1],6*(a[2]-1),1);case"H-YYYY":return new Date(a[2],6*(a[1]-1),1);case"YYYY-Q":return new Date(a[1],3*(a[2]-1),1);case"Q-YYYY":return new Date(a[2],3*(a[1]-1),1);case"YYYY-M":return new Date(a[1],a[2]-1,1);case"M-YYYY":return new Date(a[2],a[1]-1,1);case"YYYY-WW":return r(a[1],a[2],1);case"YYYY-WW-d":return r(a[1],a[2],a[3]);case"YYYY-MM-DD":return new Date(a[1],a[3]-1,a[4]);case"DD/MM/YYYY":return new Date(a[4],a[3]-1,a[1]);case"MM/DD/YYYY":return new Date(a[4],a[1]-1,a[3]);case"YYYY-MM-DD HH:MM":return new Date(a[1],a[3]-1,a[4],a[5]||0,a[6]||0,0);case"DD.MM.YYYY HH:MM":return new Date(a[4],a[3]-1,a[1],a[5]||0,a[6]||0,0);case"MM/DD/YYYY HH:MM":return new Date(a[4],a[1]-1,a[3],a[5]||0,a[6]||0,0);case"YYYY-MM-DD HH:MM:SS":return new Date(a[1],a[3]-1,a[4],a[5]||0,a[6]||0,a[7]||0);case"DD.MM.YYYY HH:MM:SS":return new Date(a[4],a[3]-1,a[1],a[5]||0,a[6]||0,a[7]||0);case"MM/DD/YYYY HH:MM:SS":return new Date(a[4],a[1]-1,a[3],a[5]||0,a[6]||0,a[7]||0)}return u++,t},toNum:function(t){return t.getTime()},fromNum:function(t){return new Date(t)},errors:function(){return u},name:function(){return"date"},format:function(t){return arguments.length?(i=t,f):i},precision:function(){return c[i].precision},formatter:function(t){if(!i)return _.identity;var e=Globalize.culture().calendar.patterns.M.replace("MMMM","MMM");switch(c[i].precision){case"year":return function(t){return _.isDate(t)?t.getFullYear():t};case"half":return function(t){return _.isDate(t)?t.getFullYear()+" H"+(t.getMonth()/6+1):t};case"quarter":return function(t){return _.isDate(t)?t.getFullYear()+" Q"+(t.getMonth()/3+1):t};case"month":return function(t){return _.isDate(t)?Globalize.format(t,"MMM yy"):t};case"week":return function(t){return _.isDate(t)?a(t).slice(0,2).join(" W"):t};case"day":return function(t,e){return _.isDate(t)?Globalize.format(t,e?"D":"d"):t};case"day-minutes":return function(t){return _.isDate(t)?Globalize.format(t,e).replace(" ","&nbsp;")+" - "+Globalize.format(t,"t").replace(" ","&nbsp;"):t};case"day-seconds":return function(t){return _.isDate(t)?Globalize.format(t,"T").replace(" ","&nbsp;"):t}}},isValid:function(t){return _.isDate(f.parse(t))},ambiguousFormats:function(){var t=[];return _.each(o,function(e,n){e==s[1]&&t.push([n,n])}),t}};return f},e.datasource={},e.datasource.delimited=function(t){function e(){if(t.url)return $.ajax({url:t.url,method:"GET",dataType:"text"}).then(function(e){return new n(t).parse(e)});if(t.csv){var e=$.Deferred(),r=e.then(function(e){return new n(t).parse(e)});return e.resolve(t.csv),r}throw"you need to provide either an URL or CSV data."}var r={dataset:e};return r};var n=function(e){e=_.extend({delimiter:"auto",quoteChar:'"',skipRows:0,emptyValue:null,transpose:!1,firstRowIsHeader:!0},e),this.__delimiterPatterns=t(e.delimiter,e.quoteChar),this.opts=e};_.extend(n.prototype,{parse:function(n){function r(t,e,n){n=n||",";for(var r,a=[[]],i=null;i=t.exec(e);){var u=i[1];u.length&&u!=n&&a.push([]),r=i[2]?i[2].replace(new RegExp('""',"g"),'"'):i[3],a[a.length-1].push(r)}a[0][0].substr(0,1)==c&&(a[0][0]=a[0][0].substr(1));var o=a.length-1,s=a[o].length-1,f=a[o][s].length-1;return a[o][s].substr(f)==c&&(a[o][s]=a[o][s].substr(0,f)),a}function a(t){var e=t,n=e.length?e.length:0,r=e[0]instanceof Array?e[0].length:0;if(0===r||0===n)return[];var a,i,u=[];for(a=0;r>a;a++)for(u[a]=[],i=0;n>i;i++)u[a][i]=e[i][a];return u}function i(t){var n=[],r={},a=t.length,i=t[0].length,u=o.skipRows,s=[];o.firstRowIsHeader&&(s=t[u],u++);for(var c=0;i>c;c++){var f=_.isString(s[c])?s[c].replace(/^\s+|\s+$/g,""):"",d=""!==f?"":1;for(f=""!==f?f:"X.";void 0!==r[f+d];)d=""===d?1:d+1;n.push({name:f+d,data:[]}),r[f+d]=!0}return _.each(_.range(u,a),function(e){_.each(n,function(n,r){n.data.push(""!==t[e][r]?t[e][r]:o.emptyValue)})}),n=_.map(n,function(t){return e.column(t.name,t.data)}),e.dataset(n)}var u=this,o=this.opts;u.__rawData=n,"auto"==o.delimiter&&(o.delimiter=u.guessDelimiter(n,o.skipRows),u.__delimiterPatterns=t(o.delimiter,o.quoteChar));var s,c="|"!=o.delimiter?"|":"#";return n=c+n.replace(/\s+$/g,"")+c,s=r(this.__delimiterPatterns,n,o.delimiter),o.transpose&&(s=a(s)),i(s)},guessDelimiter:function(e){var n=0,r=-1,a=this,i=["	",";","|",","];return _.each(i,function(i,u){var o=t(i,a.quoteChar),s=e.match(o).length;s>n&&(n=s,r=u)}),i[r]}}),e.utils={minMax:function(t){var e=[Number.MAX_VALUE,-Number.MAX_VALUE];return _.each(t,function(t){e[0]=Math.min(e[0],t.range()[0]),e[1]=Math.max(e[1],t.range()[1])}),e},dateFormat:function(t){function e(t){return function(e){r=!a||e.getMonth()!=a.getMonth(),a=e;for(var n=t.length-1,i=t[n];!i[1](e);)i=t[--n];return i[0](e)}}function n(t){var e=function(e){var n=Globalize.format(e,t);return"htt"!=t?n:n.toLowerCase()};return e}var r=!0,a=!1,i=function(t){return{date:"de"==t?"dd.":"dd",hour:"en"!=t?"H:00":"htt",minute:"de"==t?"H:mm":"h:mm",mm:"de"==t?"d.M.":"MM/dd",mmm:"de"==t?"d.MMM":"MMM dd",mmmm:"de"==t?"d. MMMM":"MMMM dd"}}(Globalize.culture().language);return e([[n("yyyy"),function(){return!0}],[n("MMM"),function(t){return 0!==t.getMonth()}],[n(i.date),function(t){return 1!=t.getDate()}],[n(7>t?i.mm:t>70?i.mmm:i.mmm),function(t){return 1!=t.getDate()&&r}],
//[time_fmt("%a %d"), function(d) { return d.getDay() && d.getDate() != 1; }],  // not monday
[n(i.hour),function(t){return t.getHours()}],[n(i.minute),function(t){return t.getMinutes()}],[n(":ss"),function(t){return t.getSeconds()}],[n(".fff"),function(t){return t.getMilliseconds()}]])},longDateFormat:function(t){return function(e){if("date"!=t.type())return e;switch(t.type(!0).precision()){case"year":return e.getFullYear();case"quarter":return e.getFullYear()+" Q"+(e.getMonth()/3+1);case"month":return Globalize.format(e,"MMM yy");case"day":return Globalize.format(e,"MMM d");case"minute":return Globalize.format(e,"t");case"second":return Globalize.format(e,"T")}}},columnNameColumn:function(t){var n=_.map(t,function(t){return t.title()});return e.column("",n)},name:function(t){return _.isFunction(t.name)?t.name():_.isString(t.name)?t.name:t},getMaxChartHeight:function(t){function e(t,e){return"auto"==$(t).css("margin-"+e)?0:+$(t).css("margin-"+e).replace("px","")}var n=0,r=0;$("body > *").each(function(t,a){var i=a.tagName.toLowerCase();"script"==i||"style"==i||"chart"==a.id||$(a).hasClass("tooltip")||$(a).hasClass("qtip")||$(a).hasClass("container")||$(a).hasClass("noscript")||(n+=$(a).outerHeight(!1)),n+=Math.max(e(a,"top"),r),r=e(a,"bottom")}),n+=r;var a=($("#chart").css("margin-top").replace("px",""),$("#chart").css("margin-bottom").replace("px",""),$(window).height()-n-8);return $.support.leadingWhitespace||(a-=15),a-=$("body").css("padding-top").replace("px",""),a-=$("body").css("padding-bottom").replace("px","")},purifyHtml:function(t,n){function r(t,e){return!_.isString(t)||t.indexOf("<")<0?t:(void 0===e&&(e=u),o[e]||(o[e]=(((e||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("")),t.replace(i,"").replace(a,function(t,n){return o[e].indexOf("<"+n.toLowerCase()+">")>-1?t:""}))}var a=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,i=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,u="<b><br><br/><i><strong><sup><sub><strike><u><em><tt>",o={};return void 0===n&&(n=u),o[n]=(((n||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),e.utils.purifyHtml=r,r(t,n)},significantDimension:function(t){function n(t){return e.utils.round(t,u)}var r,a,i=[],u=0,o=_.uniq(t);if(1==o.length)return-1*Math.floor(Math.log(o[0])/Math.LN10);_.uniq(_.map(o,n)).length==o.length?(r=function(){return _.uniq(i).length==o.length},a=-1):(r=function(){return _.uniq(i).length<o.length},a=1);var s=100;do i=_.map(o,n),u+=a;while(r()&&s-->0);return 10>s&&console.warn("maximum iteration reached",t,i,u),0>a?u+=2:u--,u},round:function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},smartRound:function(t,n){var r=e.utils.significantDimension(t);return r+=n||0,_.map(t,function(t){return e.utils.round(t,r)})},nearest:function(t,e){var n,r=Number.MAX_VALUE;return _.each(t,function(t){var a=Math.abs(t-e);r>a&&(r=a,n=t)}),n},metricSuffix:function(t){switch(t.substr(0,2).toLowerCase()){case"de":return{3:" Tsd.",6:" Mio.",9:" Mrd.",12:" Bio."};case"fr":return{3:" mil",6:" Mio",9:" Mrd"};case"es":return{3:" Mil",6:" millón"};default:return{3:"k",6:"M",9:" bil"}}},magnitudeRange:function(t){var e=Math.round(Math.log(t[0])/Math.LN10),n=Math.round(Math.log(t[1])/Math.LN10);return n-e},logTicks:function(t,e){var n=Math.round(Math.log(t)/Math.LN10),r=Math.round(Math.log(e)/Math.LN10);return _.map(_.range(n,r),function(t){return Math.pow(10,t)})}},e.utils.filter=function(t,n,r,a){function i(e){_.each(o,function(n){_.isFunction(n)&&n(t.val(e),e)})}function u(r){var o;return"auto"==r&&(r="date"==t.type()?"timescale":t.length<6?"buttons":"select"),t.length<2?function(){return!1}:("select"==r&&(o=function(e){var n=$("<select />");return t.each(function(t,e){var r=a(t);r&&n.append('<option value="'+e+'">'+(_.isString(r)?$.trim(r):r)+"</option>")}),n.change(function(t){var e=n.val();i(e)}),n.addClass("filter-ui filter-select"),n}),"buttons"==r&&(o=function(e){var r=$("<div />");r.addClass("filter-ui filter-links"),t.each(function(t,e){var i=a(t);if(i){var u=$('<a href="#'+e+'"'+(e==n?' class="active" ':"")+">"+(_.isString(i)?$.trim(i):i)+"</a>").data("row",e);r.append(u)}}),$("a",r).click(function(t){var e=$(t.target);t.preventDefault(),e.hasClass("active")||($("a",r).removeClass("active"),e.addClass("active"),i(e.data("row")))}),r.appendTo("body");var o=$("a:first",r).offset().top,s=$("a:last",r).offset().top;return o!=s?(r.remove(),u("select")(e)):r}),"timescale"==r&&(o=function(r){function a(e){var n=o.invert(e),r=Number.MAX_VALUE,a=0;return t.each(function(t,e){var i=Math.abs(t.getTime()-n.getTime());r>i&&(r=i,a=e)}),a}var u=Math.min(r.__w-30,Math.max(300,.7*r.__w)),o=d3.time.scale().domain([t.val(0),t.val(-1)]).range([0,u]),s=$("<div></div>").css({position:"relative",height:45,"margin-left":3}).addClass("filter-ui"),c=u/80,f=o.ticks(c),d=Math.round((t.val(-1).getTime()-t.val(0).getTime())/864e5),l=e.utils.dateFormat(d),m=t.type(!0).formatter(),h=o.ticks(u/8),p=function(e){return Math.max(-18,o(t.val(e))-40)};_.each(f,function(t){var e=$("<span>"+l(t)+"</span>"),n=o(t)-40,a=r.labelWidth(l(t));0>40-.5*a+n&&(n=-40+.5*a),e.css({position:"absolute",top:0,width:80,left:n,"text-align":"center",opacity:.55}),s.append(e)}),_.each(h,function(e){if(!(e.getTime()<t.val(0).getTime()||e.getTime()>t.val(-1).getTime())){var n=$('<span class="dot"></span>');n.css({position:"absolute",bottom:19,width:1,height:"1ex","border-left":"1px solid #000","vertical-align":"bottom",left:Math.round(o(e))+.5}),_.find(f,function(t){return e.getTime()==t.getTime()})||n.css({height:"0.6ex",opacity:.5}),s.append(n)}});var g=$("<div>▲</div>").css({position:"absolute",width:20,bottom:2,left:o(t.val(n))-9,"text-align":"center"});s.append(g);var v=$("<div><span></span></div>").css({position:"absolute",width:80,top:0,left:p(n),"text-align":"center"}).data("last-txt",m(t.val(n))).data("last-left",p(n));$("span",v).css({background:r.theme().colors.background,"font-weight":"bold",padding:"0 1ex"}).html(m(t.val(n))),s.append(v),$("<div />").css({position:"absolute",width:u+1,bottom:15,height:2,"border-bottom":"1px solid #000"}).appendTo(s);var M=$("<div />").css({position:"absolute",left:0,width:u,height:40});s.append(M);var b;return M.click(function(t){var e=t.clientX-M.offset().left,n=a(e);i(n),s.data("update-func")(n),clearTimeout(b)}),M.mousemove(function(e){var n=e.clientX-M.offset().left,r=a(n);$("span",v).html(m(t.val(r))),v.css({left:p(r)}),g.css({left:o(t.val(r))-10}),clearTimeout(b),b=setTimeout(function(){i(r),v.data("last-left",p(r)),v.data("last-txt",v.text())},500)}),M.mouseleave(function(){v.css({left:v.data("last-left")}),g.css({left:v.data("last-left")+30}),$("span",v).html(v.data("last-txt")),clearTimeout(b)}),s.data("update-func",function(e){g.stop().animate({left:o(t.val(e))-10},500,"expoInOut");var n=p(e),r=m(t.val(e));$("span",v).html(r),v.css({left:n}),v.data("last-left",n),v.data("last-txt",r)}),s}),o)}var o=[];r=r||"auto",a=a||_.identity,"auto"==r&&("date"==t.type()?r="timescale":"text"==t.type()&&(r=t.length<6?"buttons":"select"));var s={ui:u(r),change:function(t){o.push(t)}};return s},e.chart=function(t){function n(t){var e=c.get("metadata.data.changes",[]),n=c.get("metadata.data.transpose",!1);_.each(e,function(e){var r="row",a="column";n&&(r="column",a="row"),t.hasColumn(e[a])&&(0===e[r]?t.column(e[a]).title(e.value):t.column(e[a]).raw(e[r]-1,e.value))});var r=c.get("metadata.data.column-format",{});return _.each(r,function(e,n){e.type&&t.hasColumn(n)&&t.column(n).type(e.type),e["input-format"]&&t.hasColumn(n)&&t.column(n).type(!0).format(e["input-format"])}),t}var r,a,i,u,o,s=$.Callbacks(),c={get:function(e,n){var r=e.split("."),a=t;return _.some(r,function(t){return _.isUndefined(a)||_.isNull(a)?!0:(a=a[t],!1)}),_.isUndefined(a)||_.isNull(a)?n:a},set:function(e,n){var r=e.split("."),a=r.pop(),i=t;return _.each(r,function(t){(_.isUndefined(i[t])||_.isNull(i[t]))&&(i[t]={}),i=i[t]}),_.isEqual(i[a],n)||(i[a]=n,s.fire(c,e,n)),this},load:function(){var t;return t=e.datasource.delimited({url:"data.csv",firstRowIsHeader:c.get("metadata.data.horizontal-header",!0),transpose:c.get("metadata.data.transpose",!1)}),t.dataset().pipe(function(t){return c.dataset(t),t})},dataset:function(t){return arguments.length?(r=n(t),c):r},theme:function(t){return arguments.length?(a=t,c):a||{}},vis:function(t){return arguments.length?(i=t,i.chart(c),c):i},hasHighlight:function(){var t=c.get("metadata.visualize.highlighted-series");return _.isArray(t)&&t.length>0},isHighlighted:function(t){if(void 0===_.isUndefined(t))return!1;var n=this.get("metadata.visualize.highlighted-series"),r=e.utils.name(t);return!_.isArray(n)||0===n.length||_.indexOf(n,r)>=0},locale:function(t){return arguments.length?(o=t,Globalize.culture(o),c):o},metricPrefix:function(t){return arguments.length?(u=t,c):u},formatValue:function(t,e,n){var r=c.get("metadata.describe.number-format"),a=Number(c.get("metadata.describe.number-divisor")),i=c.get("metadata.describe.number-append","").replace(" ","&nbsp;"),u=c.get("metadata.describe.number-prepend","").replace(" ","&nbsp;");return 0!==a&&(t=Number(t)/Math.pow(10,a)),"-"!=r?((n||t==Math.round(t))&&(r=r.substr(0,1)+"0"),t=Globalize.format(t,r)):0!==a&&(t=t.toFixed(1)),e?u+t+i:t},render:function(t){if(!i||!a||!r)throw"cannot render the chart!";i.chart(c),i.__init();var e=$(t);e.parent().addClass("vis-"+i.id).addClass("theme-"+a.id),i.render(e)},attributes:function(e){return arguments.length?(t=e,c):t},onChange:s.add,columnFormatter:function(t){var n=c.get("metadata.data.column-format",{});if(n=n[t.name()]||{},"number"==t.type()&&"auto"==n){var r=e.utils.metricSuffix(c.locale()),a=t.values(),i=e.utils.significantDimension(a),u=-2>i?3*Math.round(-1*i/3):i>2?-1*i:0,o=e.utils.significantDimension(_.map(a,function(t){return t/Math.pow(10,u)}));n={"number-divisor":u,"number-append":u?r[u]||" × 10<sup>"+u+"</sup>":"","number-format":"n"+Math.max(0,o)}}return t.type(!0).formatter(n)}};return c},e.visualization=function(){var t={},n=function(e){return new t[e]};return n.register=function(n){var r=3==arguments.length?t[arguments[1]].prototype:e.visualization.base,a=arguments[arguments.length-1],i=t[n]=function(){};_.extend(i.prototype,r,{id:n},a)},n}(),e.visualization.base=function(){}.prototype,_.extend(e.visualization.base,{__init:function(){return this.__renderedDfd=$.Deferred(),window.parent&&window.parent.postMessage&&window.parent.postMessage("datawrapper:vis:init","*"),this},render:function(t){$(t).html("implement me!")},theme:function(t){if(!arguments.length)return this.__theme;this.__theme=t;var e=["horizontalGrid","verticalGrid","yAxis","xAxis"];return _.each(e,function(e){if(t.hasOwnProperty(e))for(var n in t[e]){var r=n.replace(/([A-Z])/g,"-$1").toLowerCase();t[e].hasOwnProperty(r)||(t[e][r]=t[e][n])}}),this},size:function(t,e){var n=this;return arguments.length?(n.__w=t,n.__h=e,n):[n.__w,n.__h]},get:function(t,e){return this.chart().get("metadata.visualize."+t,e)},notify:function(t){return e.backend&&_.isFunction(e.backend.notify)?e.backend.notify(t):void(window.parent&&window.parent.postMessage?window.parent.postMessage("notify:"+t,"*"):window.console&&console.log(t))},signature:function(){},translate:function(t){var e=this.meta.locale,n=this.lang;return e[t]?e[t][n]||e[t]:t},checkBrowserCompatibility:function(){return!0},chart:function(t){var e=this;if(!arguments.length)return e.__chart;e.dataset=t.dataset(),e.theme(t.theme()),e.__chart=t;var n=t.get("metadata.data.column-format",{}),r={};return _.each(n,function(t,e){r[e]=!!t.ignore}),e.dataset.filterColumns(r),e},axes:function(t){function n(t){_.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++)if(!i.hasColumn(t[e]))return!1;return!0}var r,a=this,i=a.dataset,u={},o={},s={},c=[];return r=a.chart().get("metadata.axes",{}),_.each(a.meta.axes,function(t,e){if(r[e]){var a=r[e];n(a)&&(o[e]=a,_.isArray(a)||(a=[a]),_.each(a,function(t){u[t]=!0}))}}),_.each(a.meta.axes,function(t,n){function r(e){return!u[e.name()]&&_.indexOf(t.accepts,e.type())>=0}function s(){var r=e.backend?e.backend.messages.insufficientData:"The visualization needs at least one column of the type %type to populate axis %key";c.push(r.replace("%type",t.accepts).replace("%key",n))}if(!o[n])if(t.optional)o[n]=!1;else if(t.multiple)o[n]=[],i.eachColumn(function(t){r(t)&&(u[t.name()]=!0,o[n].push(t.name()))}),o[n].length||s();else{var f=_.find(i.columns(),r);if(f)u[f.name()]=!0,o[n]=f.name();else if(_.indexOf(t.accepts,"text")>=0){var d=e.column(n,_.map(_.range(i.numRows()),function(t){return(t>25?String.fromCharCode(64+t/26):"")+String.fromCharCode(65+t%26)}),"text");i.add(d),a.chart().dataset(i),u[d.name()]=!0,o[n]=d.name()}else s()}}),c.length&&a.notify(c.join("<br />")),_.each(o,function(t,e){_.isArray(t)?(s[e]=[],_.each(t,function(t,n){s[e][n]=t!==!1?a.dataset.column(t):null})):s[e]=t!==!1?a.dataset.column(t):null}),a.axes=function(t){return t?s:o},a.axes(t)},keys:function(){var t=this,e=t.axes();if(e.labels){var n=t.dataset.column(e.labels),r=t.chart().columnFormatter(n),a=[];return n.each(function(t){a.push(String(r(t)))}),a}return[]},keyLabel:function(t){return t},reset:function(){this.clear(),$("#chart").html("").off("click").off("mousemove").off("mouseenter").off("mouseover"),$(".chart .filter-ui").remove(),$(".chart .legend").remove()},clear:function(){},renderingComplete:function(){window.parent&&window.parent.postMessage&&window.parent.postMessage("datawrapper:vis:rendered","*"),this.__renderedDfd.resolve()},rendered:function(){return this.__renderedDfd.promise()},supportsSmartRendering:function(){return!1},_svgCanvas:function(){return!1}}),e.theme=function(){function t(){var e,r,a,i,u,o=arguments[0]||{},s=1,c=arguments.length;for("object"==typeof o||_.isFunction(o)||(o={});c>s;s++)if(null!=(e=arguments[s]))for(r in e)a=o[r],i=e[r],o!==i&&(i&&n(i)?(u=a&&n(a)?a:{},o[r]=t(u,i)):void 0!==i&&(o[r]=i));return o}function n(t){return _.isObject(t)&&!_.isArray(t)&&!_.isFunction(t)}var r={},a=function(t){return r[t]};return a.register=function(n){var a=3==arguments.length?r[arguments[1]]:e.theme.base,i=arguments[arguments.length-1];r[n]=t({},a,{id:n},i)},a}(),e.theme.base={colors:{palette:["#6E7DA1","#64A4C4","#53CCDD","#4EF4E8"],secondary:["#000000","#777777","#cccccc","#ffd500","#6FAA12"],positive:"#85B4D4",negative:"#E31A1C",
// colors background and text needs to be set in CSS as well!
background:"#ffffff",text:"#000000",gradients:[["#fefaca","#008b15"],["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],["#8c510a","#d8b365","#f6e8c3","#f5f7ea","#c7eae5","#5ab4ac","#01665e"],["#c51b7d","#e9a3c9","#fde0ef","#faf6ea","#e6f5d0","#a1d76a","#4d9221"],["#b2182b","#ef8a62","#fddbc7","#f8f6e9","#d1e5f0","#67a9cf","#2166ac"]],categories:[["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"],["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]]},annotation:{background:"#000",opacity:.08},padding:{left:0,right:20,bottom:30,top:10},lineChart:{strokeWidth:3,maxLabelWidth:80,fillOpacity:.2,xLabelOffset:20},columnChart:{cutGridLines:!1,barAttrs:{"stroke-width":1},darkenStroke:18},barChart:{barAttrs:{"stroke-width":1}},xAxis:{stroke:"#333"},yAxis:{strokeWidth:1},horizontalGrid:{stroke:"#d9d9d9"},verticalGrid:!1,frame:!1,frameStrokeOnTop:!1,yTicks:!1,hover:!0,tooltip:!0,hpadding:0,vpadding:10,minWidth:100,locale:"de_DE",duration:1e3,easing:"expoInOut"}}).call(this);
//# sourceMappingURL=dw-2.0.min.js.map